<div style="padding:16px; font-family:Arial, sans-serif; height:100%; display:flex; flex-direction:column; overflow-y:auto;">
	<div style="font-size:16px; font-weight:bold; margin-bottom:12px;">
		Timeseries Excel Report (pivot)
	</div>
	<div style="display:flex; gap:12px; align-items:center; flex-wrap:wrap; margin-bottom:10px;">
		<span style="font-size:13px;">Report range:</span>
		<select id="excelPresetDropdown" style="padding:6px 8px; border:1px solid #ccc; border-radius:6px; font-size:13px;">
			<option value="last_24_hours">Last 24 hours</option>
			<option value="last_7_days">Last 7 days</option>
			<option value="last_30_days">Last 30 days</option>
			<option value="last_60_days" selected>Last 60 days</option>
			<option value="custom_days">Last XX days...</option>
			<option value="last_month">Last month</option>
			<option value="last_3_months">Last 3 months</option>
			<option value="custom_months">Last XX months...</option>
			<option value="this_year">This year</option>
			<option value="last_year">Last year</option>
		</select>
		<div id="customDaysContainer" style="display:none; align-items:center; gap:6px;">
			<input id="customDaysInput" type="number" min="1" max="365" value="14"
				style="width:60px; padding:6px 8px; border:1px solid #1976d2; border-radius:6px; font-size:13px; text-align:center;" />
			<span style="font-size:13px; color:#444;">days</span>
		</div>
		<div id="customMonthsContainer" style="display:none; align-items:center; gap:6px;">
			<input id="customMonthsInput" type="number" min="1" max="24" value="6"
				style="width:60px; padding:6px 8px; border:1px solid #1976d2; border-radius:6px; font-size:13px; text-align:center;" />
			<span style="font-size:13px; color:#444;">months</span>
		</div>
		<button id="excelExportButton"
			style="padding:10px 14px; background:#1976d2; color:white; border:0; border-radius:8px; cursor:pointer; font-size:13px; font-weight:bold;">
			Generate &amp; Download Excel
		</button>
		<span style="font-size:12px; color:#666;">
			Assets: <span id="assetCount">0</span> |
			Keys: <span id="keyCount">0</span> |
			TZ: Asia/Bangkok
		</span>
	</div>
	<div id="excelStatus" style="font-size:13px; color:#444; white-space:pre-wrap; min-height:20px; margin-bottom:8px;"></div>
	<div id="toggleRow" style="display:none; gap:8px; margin-bottom:8px;">
		<button id="toggleTableBtn"
			style="padding:6px 14px; border:0; border-radius:6px; cursor:pointer; font-size:12px; font-weight:bold;">
		</button>
		<button id="toggleDebugBtn"
			style="padding:6px 14px; border:0; border-radius:6px; cursor:pointer; font-size:12px; font-weight:bold;">
		</button>
	</div>
	<div id="tablePanel" style="display:none; flex-direction:column; flex:1; min-height:0; margin-bottom:8px;">
		<div style="flex:1; min-height:260px; position:relative; overflow:hidden; border:1px solid #e6e6e6; border-radius:10px; background:#fff;">
			<div style="position:absolute; inset:0; overflow:auto;">
				<tb-timeseries-table-widget [ctx]="ctx"></tb-timeseries-table-widget>
			</div>
		</div>
	</div>
	<div id="debugPanel" style="display:none; flex-direction:column; min-height:200px; border:1px solid #e0e0e0; border-radius:8px; margin-bottom:8px; overflow:hidden;">
		<div style="display:flex; align-items:center; justify-content:space-between; padding:6px 10px; background:#e8e8e8; border-bottom:1px solid #e0e0e0;">
			<span style="font-size:12px; font-weight:bold; color:#444;">Debug Info</span>
			<button id="copyDebugBtn"
				style="padding:3px 10px; background:#555; color:white; border:0; border-radius:4px; cursor:pointer; font-size:11px;">
				Copy
			</button>
		</div>
		<div id="debugScroll" style="flex:1; min-height:0; overflow-y:auto; padding:10px; background:#f7f7f7;">
			<pre id="debugText" style="font-size:12px; white-space:pre-wrap; font-family:monospace; margin:0;">Initializing...</pre>
		</div>
	</div>
</div>
